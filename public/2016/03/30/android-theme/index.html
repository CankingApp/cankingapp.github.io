<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="做酷的东西, 成为伟大的工程师，写匪夷所思的代码，然后和每个人成为朋友．"><title>Android Theme-安卓样式换肤实践方案 | 常兴 E 站</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/3.0.3/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/2.2.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Android Theme-安卓样式换肤实践方案</h1><a id="logo" href="/.">常兴 E 站</a><p class="description">Action Speak Louder Than Words.</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/sitemap.xml"><i class="fa fa-rss"> sitemap</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Android Theme-安卓样式换肤实践方案</h1><div class="post-meta">Mar 30, 2016<span> | </span><span class="category"><a href="/categories/android/">android</a></span></div><div class="post-content"><p>所谓的主题切换，就是能够根据不同的设定，呈现不同风格的界面给用户，也就是所谓的换肤。 本文主要总结了目前作者所知的两种实现方案.</p>
<p><img src="http://img.blog.csdn.net/20160331180056383" alt="安卓换肤"></p>
<a id="more"></a>
<h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>一直以来,认为App换肤是件很酷的东西,不同用户可以自己打造喜欢的颜色,类似墨迹,QQ,或是软件夜间模式,给用户很酷的体验.</p>
<p>在写这个换肤实践方案之前,我也参考了其他人的一些总结,基本上大家都是从这几个思路去实现, 如果出现有误或者不够详细的地方，希望大家提出意见或者自行进行扩展.</p>
<p>基本上换肤实现思路有两类: 1):应用内自定义style. 2):外部加载(apk,压缩资源,插件等) . 本文重要讲内置style及实现的相关步骤, 外部加载只不过是中间加了一部分数据下载和处理,有兴趣的同学自行baidu/google.</p>
<h2 id="内置Style"><a href="#内置Style" class="headerlink" title="内置Style"></a>内置Style</h2><h3 id="1-自定义软件中换肤需要统一处理的属性名-如下-atts-xml"><a href="#1-自定义软件中换肤需要统一处理的属性名-如下-atts-xml" class="headerlink" title="1.自定义软件中换肤需要统一处理的属性名,如下 atts.xml"></a>1.自定义软件中换肤需要统一处理的属性名,如下 atts.xml</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?</span>xml version=<span class="string">"1.0"</span> encoding=<span class="string">"utf-8"</span><span class="meta">?&gt;</span></span></span><br><span class="line"><span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">attr</span> <span class="attr">name</span>=<span class="string">"mainColor"</span> <span class="attr">format</span>=<span class="string">"color"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">attr</span> <span class="attr">name</span>=<span class="string">"mainPrimaryTextColor"</span> <span class="attr">format</span>=<span class="string">"color"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">attr</span> <span class="attr">name</span>=<span class="string">"mainPrimaryLightTextColor"</span> <span class="attr">format</span>=<span class="string">"color"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">attr</span> <span class="attr">name</span>=<span class="string">"mainBgColor"</span> <span class="attr">format</span>=<span class="string">"color"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>attr里可以定义各种属性类型，如color、float、integer、boolean、dimension（sp、dp/dip、px、pt…）、reference（指向本地资源）等等。</p>
<h3 id="2-定义主题"><a href="#2-定义主题" class="headerlink" title="2.定义主题"></a>2.定义主题</h3><p>我们需要在资源文件中定义若干套主题。并且在主题中设置各个属性的值。本例子中,重要是针对软件颜色做了不同样式的定义.</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&lt;style <span class="built_in">name</span>=<span class="string">"AppTheme.Base.Green"</span>&gt;</span><br><span class="line">    &lt;<span class="built_in">item</span> <span class="built_in">name</span>=<span class="string">"colorPrimary"</span>&gt;<span class="comment">#4CAF50&lt;/item&gt;</span></span><br><span class="line">    &lt;<span class="built_in">item</span> <span class="built_in">name</span>=<span class="string">"colorPrimaryDark"</span>&gt;<span class="comment">#388E3C&lt;/item&gt;</span></span><br><span class="line">    &lt;<span class="built_in">item</span> <span class="built_in">name</span>=<span class="string">"colorAccent"</span>&gt;<span class="comment">#9E9E9E&lt;/item&gt;</span></span><br><span class="line">    &lt;<span class="built_in">item</span> <span class="built_in">name</span>=<span class="string">"mainBgColor"</span>&gt;<span class="comment">#C8E6C9&lt;/item&gt;</span></span><br><span class="line">    &lt;<span class="built_in">item</span> <span class="built_in">name</span>=<span class="string">"mainColor"</span>&gt;<span class="comment">#4CAF50&lt;/item&gt;</span></span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br><span class="line">&lt;style <span class="built_in">name</span>=<span class="string">"AppTheme.Base.Blue"</span>&gt;</span><br><span class="line">    &lt;<span class="built_in">item</span> <span class="built_in">name</span>=<span class="string">"colorPrimary"</span>&gt;<span class="comment">#2196F3&lt;/item&gt;</span></span><br><span class="line">    &lt;<span class="built_in">item</span> <span class="built_in">name</span>=<span class="string">"colorPrimaryDark"</span>&gt;<span class="comment">#1976D2&lt;/item&gt;</span></span><br><span class="line">    &lt;<span class="built_in">item</span> <span class="built_in">name</span>=<span class="string">"colorAccent"</span>&gt;<span class="comment">#607D8B&lt;/item&gt;</span></span><br><span class="line">    &lt;<span class="built_in">item</span> <span class="built_in">name</span>=<span class="string">"mainBgColor"</span>&gt;<span class="comment">#BBDEFB&lt;/item&gt;</span></span><br><span class="line">    &lt;<span class="built_in">item</span> <span class="built_in">name</span>=<span class="string">"mainColor"</span>&gt;<span class="comment">#2196F3&lt;/item&gt;</span></span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br><span class="line">&lt;style <span class="built_in">name</span>=<span class="string">"AppTheme.Base.Purple"</span>&gt;</span><br><span class="line">    &lt;<span class="built_in">item</span> <span class="built_in">name</span>=<span class="string">"colorPrimary"</span>&gt;<span class="comment">#673AB7&lt;/item&gt;</span></span><br><span class="line">    &lt;<span class="built_in">item</span> <span class="built_in">name</span>=<span class="string">"colorPrimaryDark"</span>&gt;<span class="comment">#512DA8&lt;/item&gt;</span></span><br><span class="line">    &lt;<span class="built_in">item</span> <span class="built_in">name</span>=<span class="string">"colorAccent"</span>&gt;<span class="comment">#795548&lt;/item&gt;</span></span><br><span class="line">    &lt;<span class="built_in">item</span> <span class="built_in">name</span>=<span class="string">"mainBgColor"</span>&gt;<span class="comment">#D1C4E9&lt;/item&gt;</span></span><br><span class="line">    &lt;<span class="built_in">item</span> <span class="built_in">name</span>=<span class="string">"mainColor"</span>&gt;<span class="comment">#673AB7&lt;/item&gt;</span></span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br><span class="line">&lt;style <span class="built_in">name</span>=<span class="string">"AppTheme.Base.Grey"</span>&gt;</span><br><span class="line">    &lt;<span class="built_in">item</span> <span class="built_in">name</span>=<span class="string">"colorPrimary"</span>&gt;<span class="comment">#607D8B&lt;/item&gt;</span></span><br><span class="line">    &lt;<span class="built_in">item</span> <span class="built_in">name</span>=<span class="string">"colorPrimaryDark"</span>&gt;<span class="comment">#455A64&lt;/item&gt;</span></span><br><span class="line">    &lt;<span class="built_in">item</span> <span class="built_in">name</span>=<span class="string">"colorAccent"</span>&gt;<span class="comment">#FFC107&lt;/item&gt;</span></span><br><span class="line">    &lt;<span class="built_in">item</span> <span class="built_in">name</span>=<span class="string">"mainBgColor"</span>&gt;<span class="comment">#CFD8DC&lt;/item&gt;</span></span><br><span class="line">    &lt;<span class="built_in">item</span> <span class="built_in">name</span>=<span class="string">"mainColor"</span>&gt;<span class="comment">#607D8B&lt;/item&gt;</span></span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
<h3 id="3-布局文件中使用"><a href="#3-布局文件中使用" class="headerlink" title="3.布局文件中使用"></a>3.布局文件中使用</h3><p>资源定义好后,需要订制样式的控件需要引用我们自定义的属性,使用方法如下:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?</span>xml version=<span class="string">"1.0"</span> encoding=<span class="string">"utf-8"</span><span class="meta">?&gt;</span></span></span><br><span class="line"><span class="tag">&lt;<span class="name">android.support.v7.widget.Toolbar</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span><br><span class="line">    <span class="attr">xmlns:app</span>=<span class="string">"http://schemas.android.com/apk/res-auto"</span></span><br><span class="line">    <span class="attr">android:id</span>=<span class="string">"@+id/toolbar"</span></span><br><span class="line">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span><br><span class="line">    <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span><br><span class="line">    <span class="attr">android:paddingTop</span>=<span class="string">"@dimen/toolbar_padding_top"</span></span><br><span class="line">    <span class="attr">android:background</span>=<span class="string">"?attr/mainColor"</span></span><br><span class="line">    <span class="attr">android:minHeight</span>=<span class="string">"?attr/actionBarSize"</span></span><br><span class="line">    <span class="attr">app:theme</span>=<span class="string">"@style/ThemeOverlay.AppCompat.Dark.ActionBar"</span></span><br><span class="line">    <span class="attr">app:popupTheme</span>=<span class="string">"@style/ThemeOverlay.AppCompat.Light"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p>这里只列出了tool应用颜色的例子<em>android:background=”?attr/mainColor”</em> , 当然还可以使用?attr/colorValue、?attr/stringValue与?attr/referenceValue来引用主题中的颜色值、字符串以及图片。</p>
<h3 id="4-设置主题及布局文件"><a href="#4-设置主题及布局文件" class="headerlink" title="4.设置主题及布局文件"></a>4.设置主题及布局文件</h3><p>布局文件与主题都写好了，接下来我们就要在Activity的onCreate方法里的setContextView前使用了。这里最好写在BaseActivity中,更具share保存的样式值,来动态设置theme</p>
<figure class="highlight hsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">private void setBaseTheme() &#123;</span><br><span class="line">    SharedPreferences sharedPreferences = getSharedPreferences(</span><br><span class="line">            Consts.SHARE_NAME, MODE_PRIVATE)<span class="comment">;</span></span><br><span class="line">    <span class="keyword">int</span> themeType = sharedPreferences.getInt(<span class="string">"theme_type"</span>, <span class="number">0</span>)<span class="comment">;</span></span><br><span class="line">    <span class="keyword">int</span> themeId<span class="comment">;</span></span><br><span class="line">    <span class="keyword">switch</span> (themeType) &#123;</span><br><span class="line">        <span class="keyword">case</span> THEME_GREEN:</span><br><span class="line">            themeId = R.style.AppTheme_Base_Green<span class="comment">;</span></span><br><span class="line">            <span class="keyword">break</span><span class="comment">;</span></span><br><span class="line">        <span class="keyword">case</span> ThEME_BLUE:</span><br><span class="line">            themeId = R.style.AppTheme_Base_Blue<span class="comment">;</span></span><br><span class="line">            <span class="keyword">break</span><span class="comment">;</span></span><br><span class="line">        <span class="keyword">case</span> THEME_ORANGE:</span><br><span class="line">            themeId = R.style.AppTheme_Base_Orange<span class="comment">;</span></span><br><span class="line">            <span class="keyword">break</span><span class="comment">;</span></span><br><span class="line">        <span class="keyword">case</span> THEME_TEAL:</span><br><span class="line">            themeId = R.style.AppTheme_Base_Teal<span class="comment">;</span></span><br><span class="line">            <span class="keyword">break</span><span class="comment">;</span></span><br><span class="line">        <span class="keyword">case</span> THEME_BROWN:</span><br><span class="line">            themeId = R.style.AppTheme_Base_Brown<span class="comment">;</span></span><br><span class="line">            <span class="keyword">break</span><span class="comment">;</span></span><br><span class="line">        <span class="keyword">case</span> THEME_GREY:</span><br><span class="line">            themeId = R.style.AppTheme_Base_Grey<span class="comment">;</span></span><br><span class="line">            <span class="keyword">break</span><span class="comment">;</span></span><br><span class="line">        <span class="keyword">case</span> THEME_PURPLE:</span><br><span class="line">            themeId = R.style.AppTheme_Base_Purple<span class="comment">;</span></span><br><span class="line">            <span class="keyword">break</span><span class="comment">;</span></span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            themeId = R.style.AppTheme_Base_Default<span class="comment">;</span></span><br><span class="line">    &#125;</span><br><span class="line">    setTheme(themeId)<span class="comment">;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="5-样式生效方法"><a href="#5-样式生效方法" class="headerlink" title="5.样式生效方法"></a>5.样式生效方法</h3><p>谈到生效方法,大家会有很多说法,也有很多思路, 当然直接设置后立即生效体验会好点, 但是系统限制, 正常的化需要重启activity.</p>
<h4 id="1自定义需要样式变换的所有View-不需要重启"><a href="#1自定义需要样式变换的所有View-不需要重启" class="headerlink" title="1自定义需要样式变换的所有View, 不需要重启"></a>1自定义需要样式变换的所有View, 不需要重启</h4><p>代表性项目 <a href="https://github.com/dersoncheng/MultipleTheme" target="_blank" rel="external">MultipleTheme</a>, 为了不重启activity, 自定义了所有需要样式变动的View, 原理为通过对rootView进行遍历，对所有实现了ColorUiInterface的view/viewgroup进行setTheme操作来实现即使刷新的。方式臃肿粗暴, 虽然是不需要重启activity,还可以针对每个view变换过程做动画,但是个人不推荐.</p>
<h4 id="2动态活取每个需要样式变更控件-活取atts值-对每个控件操作"><a href="#2动态活取每个需要样式变更控件-活取atts值-对每个控件操作" class="headerlink" title="2动态活取每个需要样式变更控件, 活取atts值,对每个控件操作"></a>2动态活取每个需要样式变更控件, 活取atts值,对每个控件操作</h4><p>这种也不用重启activity, 代表性项目 <a href="https://github.com/bboyfeiyu/Colorful" target="_blank" rel="external">Colorful</a>,虽然对比上一种方式从业务逻辑脱了了一部分,但还是有点繁杂,需要对每个控件做 Setter</p>
<figure class="highlight cos"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">ListView  mNewsListView = (ListView) findViewById(<span class="keyword">R</span>.id.listview)<span class="comment">;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 为ListView设置要修改的属性,在这里没有对ListView本身的属性做修改</span></span><br><span class="line">ViewGroupSetter listViewSetter = <span class="keyword">new</span> ViewGroupSetter(mNewsListView, <span class="number">0</span>)<span class="comment">;</span></span><br><span class="line"><span class="comment">// 绑定ListView的Item View中的news_title视图，在换肤时修改它的text_color属性</span></span><br><span class="line">listViewSetter.childViewTextColor(<span class="keyword">R</span>.id.news_title, <span class="keyword">R</span>.attr.text_color)<span class="comment">;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 构建Colorful对象</span></span><br><span class="line">Colorful mColorful = <span class="keyword">new</span> Colorful.Builder(this)</span><br><span class="line">	.backgroundDrawable(<span class="keyword">R</span>.id.root_view, <span class="keyword">R</span>.attr.root_view_bg) <span class="comment">// 设置view的背景图片</span></span><br><span class="line">	.backgroundColor(<span class="keyword">R</span>.id.change_btn, <span class="keyword">R</span>.attr.btn_bg) <span class="comment">// 设置按钮的背景色</span></span><br><span class="line">	.textColor(<span class="keyword">R</span>.id.textview, <span class="keyword">R</span>.attr.text_color) <span class="comment">// 设置文本颜色</span></span><br><span class="line">	.setter(listViewSetter)           <span class="comment">// 手动设置setter</span></span><br><span class="line">	.create()<span class="comment">;</span></span><br></pre></td></tr></table></figure>
<h4 id="3乖乖重启activity"><a href="#3乖乖重启activity" class="headerlink" title="3乖乖重启activity"></a>3乖乖重启activity</h4><p>既然这个多方法都不能完美去完成项目, 那我们不如按照官方方重启activity,为了美化转变效果,可以正对activity做一些动画,效果也是不错, 如下视频.</p>
<iframe frameborder="0" width="640" height="498" src="http://v.qq.com/iframe/player.html?vid=q0191cq7h61&tiny=0&auto=0" allowfullscreen></iframe>


<h3 id="6-代码中如何动态活取自定义属性值"><a href="#6-代码中如何动态活取自定义属性值" class="headerlink" title="6.代码中如何动态活取自定义属性值"></a>6.代码中如何动态活取自定义属性值</h3><p>有两种方法如下:</p>
<figure class="highlight hsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">       TypedArray a = obtainStyledAttributes(new <span class="keyword">int</span>[]&#123;R.attr.mainBgColor, </span><br><span class="line">R.attr.mainColor&#125;)<span class="comment">;</span></span><br><span class="line"><span class="keyword">int</span> <span class="keyword">color</span> = a.getColor(<span class="number">0</span>, <span class="keyword">Color</span>.BLACK)</span><br></pre></td></tr></table></figure>
<figure class="highlight elm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">TypedValue</span> typedValue = new <span class="type">TypedValue</span>();</span><br><span class="line"><span class="title">newTheme</span>.resolveAttribute(mAttrResId, typedValue, true)</span><br></pre></td></tr></table></figure>
<h2 id="聊聊apk方式的主题实现"><a href="#聊聊apk方式的主题实现" class="headerlink" title="聊聊apk方式的主题实现"></a>聊聊apk方式的主题实现</h2><p>APK主题方案和主题包保存到SD卡上(墨迹,搜狗实现方式)的方案类似,只不过是apk压缩格式,一些资源的引用可以调用系统api。</p>
<p>APK主题方案的基本思路是：在Android中，所有的资源都是基于包的。资源以id进行标识，在同一个应用中，每个资源都有唯一标识。但在不同的应用中，可以有相同的id。因此，只要获取到了其他应用的Context对象，就可以通过它的getRsources获取到其绑定的资源对象。然后，就可以使用Resources的getXXX方法获取字符串、颜色、dimension、图片等。<br>要想获取其他应用的Context对象，Android已经为我们提供好了接口。那就是android.content.ContextWrapper.createPackageContext(String packageName, int flags)方法。</p>
<figure class="highlight hsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">try &#123; </span><br><span class="line">           String remotePackage = <span class="string">"com.your.themepackagename"</span><span class="comment">;  </span></span><br><span class="line">           Context remoteContext = createPackageContext(remotePackage,  </span><br><span class="line">                   CONTEXT_IGNORE_SECURITY)<span class="comment">;  </span></span><br><span class="line">           Resources remoteResources = remoteContext.getResources()<span class="comment">;  </span></span><br><span class="line">           text.setText(remoteResources.getText(remoteResources.getIdentifier(<span class="string">"application_name"</span>, <span class="string">"string"</span>, remotePackage)))<span class="comment">;  </span></span><br><span class="line">           <span class="keyword">color</span>.setTextColor(remoteResources.getColor(remoteResources.getIdentifier(<span class="string">"color_name"</span>, <span class="string">"color"</span>, remotePackage)))<span class="comment">;  </span></span><br><span class="line">           image.setImageDrawable(remoteResources.getDrawable(remoteResources.getIdentifier(<span class="string">"ic_icon"</span>, <span class="string">"drawable"</span>, remotePackage)))<span class="comment">;  </span></span><br><span class="line">       &#125; catch (NameNotFoundException e) &#123;  </span><br><span class="line">           e.printStackTrace()<span class="comment">;  </span></span><br><span class="line">       &#125;</span><br></pre></td></tr></table></figure>
<hr>
<p>除了压缩包,apk包等实现方式,还可以考虑插件实现方式,目的都是更好的解耦,更方便的迭代项目.<br>实践源码<a href="https://github.com/CankingApp/AndroidTheme" target="_blank" rel="external">Github</a></p>
</div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="http://cankingapp.github.io/2016/03/30/android-theme/" data-id="cisk23yei0006hd750pkmsext" class="article-share-link">分享到</a><div class="tags"><a href="/tags/theme/">theme</a></div><div class="post-nav"><a href="/2016/04/08/npm-update-errer/" class="pre">Node 升级工具n 大坑</a><a href="/2016/03/30/ffmpeg/" class="next">视频转gif图片格式－好用的软件</a></div></div></div></div><div class="pure-u-1-4"><div id="sidebar"><div class="widget"><form action="//www.baidu.com/baidu" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="search" name="word" maxlength="20" placeholder="Search"/><input type="hidden" name="si" value="http://cankingapp.github.io"/><input name="tn" type="hidden" value="bds"/><input name="cl" type="hidden" value="3"/><input name="ct" type="hidden" value="2097152"/><input name="s" type="hidden" value="on"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/android/">android</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hexo/">hexo</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/node/">node</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/python/">python</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/tool/">tool</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/小米手机悬浮窗权限/" style="font-size: 15px;">小米手机悬浮窗权限</a> <a href="/tags/android/" style="font-size: 15px;">android</a> <a href="/tags/增量升级/" style="font-size: 15px;">增量升级</a> <a href="/tags/theme/" style="font-size: 15px;">theme</a> <a href="/tags/ffmpeg/" style="font-size: 15px;">ffmpeg</a> <a href="/tags/node/" style="font-size: 15px;">node</a> <a href="/tags/python/" style="font-size: 15px;">python</a> <a href="/tags/hexo/" style="font-size: 15px;">hexo</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2016/06/02/access-float/">辅助功能 之 小米手机悬浮窗权限</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/08/npm-update-errer/">Node 升级工具n 大坑</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/30/android-theme/">Android Theme-安卓样式换肤实践方案</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/30/ffmpeg/">视频转gif图片格式－好用的软件</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/22/apk-backup/">安卓设备上备份已安装应用的apk包技术实现方案</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/18/python/">Python入门-函数的使用到Python的发布安装</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/18/android-permission/">Android 6.0系统中权限问题调用 - Permission in Android M</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/18/notification-mgr/">NotificationListenerService 安卓通知栏管理详解及分析</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/18/Hexo-blog/">Hexo-免费博客搭建使用讲解</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/17/hello-world/">Hello Hexo World !</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://cankingapp.github.io/fitness/" title="健美计步器" target="_blank">健美计步器</a><ul></ul><a href="http://zhushou.360.cn/detail/index/soft_id/260762" title="充电助手" target="_blank">充电助手</a><ul></ul><a href="http://sudoku.strikingly.com/" title="爱我数独" target="_blank">爱我数独</a><ul></ul><a href="http://stopwatch.strikingly.com/" title="精确秒表" target="_blank">精确秒表</a><ul></ul><a href="http://www.wandoujia.com/apps/net.canking.gameby" title="色 变" target="_blank">色 变</a><ul></ul><a href="http://canking.strikingly.com/" title="自我简介" target="_blank">自我简介</a><ul></ul><a href="http://cankingapp.github.io/fitness/h5game/index.html" title="H5 Game" target="_blank">H5 Game</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">© <a href="/." rel="nofollow">常兴 E 站.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> changxing</a> by<a rel="nofollow" target="_blank" href="https://github.com/CankingApp/"> Github.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css?v=0.0.0"><script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_1258594405'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s11.cnzz.com/z_stat.php%3Fid%3D1258594405%26show%3Dpic' type='text/javascript'%3E%3C/script%3E"));</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>